[gd_scene load_steps=15 format=3 uid="uid://bodjd04q3c2pm"]

[ext_resource type="Script" path="res://Scripts/Beast/BeastController.gd" id="1_ru7bn"]
[ext_resource type="Script" path="res://Scripts/Beast/States/Chase.gd" id="3_32p2h"]
[ext_resource type="Script" path="res://Scripts/Beast/State_Machine.gd" id="3_y8enf"]
[ext_resource type="Script" path="res://Scripts/Beast/States/Idle.gd" id="4_bqnrj"]
[ext_resource type="Script" path="res://Scripts/Beast/States/Stuck.gd" id="5_v0tlw"]
[ext_resource type="Script" path="res://Scripts/Beast/Detection.gd" id="6_tgxsq"]
[ext_resource type="PackedScene" uid="uid://c6bpw4yb6jowb" path="res://Assets/Meshes/Werewolf/werewolf.fbx" id="7_cxrpn"]
[ext_resource type="Script" path="res://Assets/Meshes/Werewolf/werewolf.gd" id="8_lwqv7"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_s6p0v"]
albedo_color = Color(0.92549, 0.164706, 0, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_m5h5e"]
material = SubResource("StandardMaterial3D_s6p0v")

[sub_resource type="BoxMesh" id="BoxMesh_xby36"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_wdh8a"]

[sub_resource type="SphereShape3D" id="SphereShape3D_8nyv0"]
radius = 1.27219

[sub_resource type="CylinderShape3D" id="CylinderShape3D_06e3m"]
radius = 18.0

[node name="Beast" type="CharacterBody3D" node_paths=PackedStringArray("nav", "detection")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
collision_layer = 2
collision_mask = 11
axis_lock_angular_x = true
axis_lock_angular_z = true
motion_mode = 1
wall_min_slide_angle = 0.0
script = ExtResource("1_ru7bn")
nav = NodePath("NavigationAgent3D")
rotation_speed = 5.0
detection = NodePath("Detection")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
avoidance_enabled = true
height = 2.0
radius = 0.7
max_speed = 100.0

[node name="FaceDirection" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1)

[node name="StateMachine" type="Node3D" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_y8enf")
initial_state = NodePath("Idle")

[node name="Chase" type="Node" parent="StateMachine" node_paths=PackedStringArray("enemy", "stuckRay", "area")]
script = ExtResource("3_32p2h")
enemy = NodePath("../..")
stuckRay = NodePath("../../Detection/StuckRays/stuckRay")
area = NodePath("../../Detection/Near")

[node name="Idle" type="Node" parent="StateMachine" node_paths=PackedStringArray("enemy", "detection")]
script = ExtResource("4_bqnrj")
enemy = NodePath("../..")
detection = NodePath("../../Detection")

[node name="Stuck" type="Node" parent="StateMachine" node_paths=PackedStringArray("ray", "beast")]
script = ExtResource("5_v0tlw")
ray = NodePath("../../Detection/StuckRays/stuckRay")
beast = NodePath("../..")

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(0.8, 0, 0, 0, 0.8, 0, 0, 0, 0.8, 0, 0, 0)
visible = false
mesh = SubResource("CapsuleMesh_m5h5e")

[node name="MeshInstance3D" type="MeshInstance3D" parent="MeshInstance3D"]
transform = Transform3D(0.586937, 0, 0, 0, 0.586937, 0, 0, 0, 0.586937, 0, 0.352212, -0.277925)
mesh = SubResource("BoxMesh_xby36")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(0.8, 0, 0, 0, 0.8, 0, 0, 0, 0.8, 0, 0, 0)
shape = SubResource("CapsuleShape3D_wdh8a")

[node name="Detection" type="Node3D" parent="." node_paths=PackedStringArray("areaFar", "areaNear", "beast")]
script = ExtResource("6_tgxsq")
areaFar = NodePath("Far")
areaNear = NodePath("Near")
beast = NodePath("..")

[node name="StuckRays" type="Node3D" parent="Detection"]

[node name="stuckRay" type="RayCast3D" parent="Detection/StuckRays"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.647235, -0.467208)
target_position = Vector3(0, 0, -1.5)
collision_mask = 16
collide_with_areas = true
collide_with_bodies = false
debug_shape_custom_color = Color(0.784314, 0.435294, 0.333333, 1)

[node name="stuckRay2" type="RayCast3D" parent="Detection/StuckRays"]
transform = Transform3D(0.766044, 0, 0.642788, 0, 1, 0, -0.642788, 0, 0.766044, 0, -0.647235, -0.467208)
target_position = Vector3(0, 0, -1.5)
collision_mask = 16
collide_with_areas = true
collide_with_bodies = false
debug_shape_custom_color = Color(0.784314, 0.435294, 0.333333, 1)

[node name="stuckRay3" type="RayCast3D" parent="Detection/StuckRays"]
transform = Transform3D(0.766044, 0, -0.642788, 0, 1, 0, 0.642788, 0, 0.766044, 0, -0.647235, -0.467208)
target_position = Vector3(0, 0, -1.5)
collision_mask = 16
collide_with_areas = true
collide_with_bodies = false
debug_shape_custom_color = Color(0.784314, 0.435294, 0.333333, 1)

[node name="Head" type="Node3D" parent="Detection"]

[node name="0" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="10" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(1, 0, 0, 0, 0.996195, 0.0871557, 0, -0.0871557, 0.996195, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="11" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(1, 0, 0, 0, 0.996195, -0.0871557, 0, 0.0871557, 0.996195, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="1" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(0.965926, 0, -0.258819, 0, 1, 0, 0.258819, 0, 0.965926, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="12" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(0.996195, 0, -0.0871557, 0, 1, 0, 0.0871557, 0, 0.996195, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="13" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(0.996195, 0, 0.0871557, 0, 1, 0, -0.0871557, 0, 0.996195, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="2" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(0.965926, 0, 0.258819, 0, 1, 0, -0.258819, 0, 0.965926, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="3" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(1, 0, 0, 0, 0.965926, -0.258819, 0, 0.258819, 0.965926, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="4" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(1, 0, 0, 0, 0.965926, 0.258819, 0, -0.258819, 0.965926, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="5" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(1, 0, 0, 0, 0.766044, -0.642788, 0, 0.642788, 0.766044, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -10)
collision_mask = 15

[node name="6" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(0.766044, 0, -0.642788, 0, 1, 0, 0.642788, 0, 0.766044, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -7)
collision_mask = 15

[node name="7" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(0.766044, 0, 0.642788, 0, 1, 0, -0.642788, 0, 0.766044, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -7)
collision_mask = 15

[node name="8" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -5)
collision_mask = 15

[node name="9" type="RayCast3D" parent="Detection/Head"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 0.352765, -0.467208)
target_position = Vector3(0, 0, -5)
collision_mask = 15

[node name="Near" type="Area3D" parent="Detection"]
collision_layer = 0
collision_mask = 6

[node name="CollisionShape3D" type="CollisionShape3D" parent="Detection/Near"]
shape = SubResource("SphereShape3D_8nyv0")

[node name="Far" type="Area3D" parent="Detection"]
collision_layer = 0
collision_mask = 6

[node name="CollisionShape3D" type="CollisionShape3D" parent="Detection/Far"]
shape = SubResource("CylinderShape3D_06e3m")

[node name="werewolf" parent="." instance=ExtResource("7_cxrpn")]
transform = Transform3D(-0.20681, 0, -0.036466, 0, 0.21, 0, 0.036466, 0, -0.20681, 0, -0.792255, 0)
script = ExtResource("8_lwqv7")

[node name="Skeleton3D" parent="werewolf/root" index="0"]
bones/0/position = Vector3(0, 1.5865, 6.12343)
bones/0/rotation = Quaternion(0.770926, -2.2538e-06, -2.72412e-06, 0.636925)
bones/1/position = Vector3(2.28926e-07, 1.1077, 0.0324007)
bones/1/rotation = Quaternion(0.302791, -0.00314295, -0.00100068, 0.953051)
bones/2/position = Vector3(6.38597e-09, 1.16337, -1.90739e-07)
bones/2/rotation = Quaternion(0.0746523, 0.0032922, -0.000246457, 0.997204)
bones/3/rotation = Quaternion(-0.077251, -2.37571e-07, -3.9478e-11, 0.997012)
bones/4/rotation = Quaternion(0.287579, 0.00644311, 0.00193461, 0.957733)
bones/5/rotation = Quaternion(0.0722903, 1.33576e-06, 0.000972783, 0.997383)
bones/6/rotation = Quaternion(-0.642967, -0.00517744, -0.00430297, 0.765864)
bones/7/position = Vector3(-0.881303, 0.374006, -0.47673)
bones/7/rotation = Quaternion(-0.548093, 0.531409, 0.563569, 0.315577)
bones/8/rotation = Quaternion(-0.337073, -0.0619817, 0.185601, 0.920919)
bones/9/rotation = Quaternion(8.54861e-09, 0.397361, -1.26823e-07, 0.917662)
bones/10/rotation = Quaternion(3.62036e-08, 0.202894, -3.14199e-08, 0.979201)
bones/11/rotation = Quaternion(-2.32189e-07, 2.12377e-07, 0.49751, 0.867458)
bones/12/rotation = Quaternion(1.93335e-07, -0.000293792, 1.45155e-07, 1)
bones/13/rotation = Quaternion(-2.36903e-07, -0.154832, -1.19812e-07, 0.987941)
bones/13/scale = Vector3(1, 1, 1)
bones/14/rotation = Quaternion(-0.0483112, -0.00296799, -0.0690557, 0.996438)
bones/16/rotation = Quaternion(-0.28194, 0.0307276, 0.0789019, 0.955688)
bones/17/rotation = Quaternion(-0.0922656, -0.0196086, -0.0267776, 0.995181)
bones/19/rotation = Quaternion(-0.166322, -0.00257239, 0.00724903, 0.986041)
bones/20/rotation = Quaternion(-0.283485, 0.0214084, -0.0553207, 0.957141)
bones/21/rotation = Quaternion(-0.296887, -0.0210582, 0.0313041, 0.954167)
bones/22/rotation = Quaternion(-0.0186135, 0.0124708, -0.0638129, 0.99771)
bones/23/rotation = Quaternion(-0.209768, 0.00618887, -0.031171, 0.977235)
bones/24/rotation = Quaternion(-0.309797, -0.00346535, -0.0249648, 0.950469)
bones/25/rotation = Quaternion(-0.228839, 0.0106934, -0.0296443, 0.972954)
bones/26/rotation = Quaternion(-0.0280327, 0.0257822, -0.110935, 0.993098)
bones/27/rotation = Quaternion(-0.248134, 0.00497382, -0.0196422, 0.968514)
bones/28/rotation = Quaternion(-0.289086, 0.00571023, -0.0111516, 0.957221)
bones/29/rotation = Quaternion(-0.308144, 0.024941, -0.0282549, 0.950593)
bones/30/rotation = Quaternion(-0.0485098, 0.0416134, -0.148497, 0.986845)
bones/31/rotation = Quaternion(-0.262372, 0.018835, -0.0545948, 0.963237)
bones/32/rotation = Quaternion(-0.313217, -0.0048552, 0.00867474, 0.94963)
bones/33/rotation = Quaternion(-0.343146, -0.00202826, 0.00216268, 0.939278)
bones/34/position = Vector3(0.881303, 0.374007, -0.476731)
bones/34/rotation = Quaternion(0.548093, 0.531409, 0.563569, -0.315577)
bones/35/rotation = Quaternion(-0.336906, 0.0619295, -0.18557, 0.92099)
bones/36/rotation = Quaternion(1.80484e-07, -0.397353, 1.47661e-07, 0.917666)
bones/37/rotation = Quaternion(1.24327e-07, -0.202895, 5.711e-08, 0.9792)
bones/38/rotation = Quaternion(5.28036e-07, 2.95225e-07, -0.49751, 0.867458)
bones/39/rotation = Quaternion(1.64067e-07, 0.000293702, -7.90588e-08, 1)
bones/40/rotation = Quaternion(-2.43474e-07, 0.154814, 2.12447e-07, 0.987944)
bones/40/scale = Vector3(1, 1, 1)
bones/41/rotation = Quaternion(-0.0483113, 0.00296792, 0.0690561, 0.996438)
bones/43/rotation = Quaternion(-0.281936, -0.0307301, -0.0789065, 0.955689)
bones/44/rotation = Quaternion(-0.0922654, 0.0196085, 0.0267776, 0.995181)
bones/46/rotation = Quaternion(-0.166322, 0.00257245, -0.00724907, 0.986041)
bones/47/rotation = Quaternion(-0.283485, -0.0214085, 0.0553206, 0.95714)
bones/48/rotation = Quaternion(-0.296887, 0.0210583, -0.0313042, 0.954167)
bones/49/rotation = Quaternion(-0.0186135, -0.0124707, 0.0638129, 0.99771)
bones/50/rotation = Quaternion(-0.209768, -0.00618884, 0.031171, 0.977235)
bones/51/rotation = Quaternion(-0.309797, 0.00346532, 0.0249648, 0.950469)
bones/52/rotation = Quaternion(-0.228839, -0.0106934, 0.0296443, 0.972954)
bones/53/rotation = Quaternion(-0.0280327, -0.0257821, 0.110935, 0.993098)
bones/54/rotation = Quaternion(-0.248116, -0.00497351, 0.0196423, 0.968518)
bones/55/rotation = Quaternion(-0.289086, -0.00571018, 0.0111516, 0.957221)
bones/56/rotation = Quaternion(-0.308144, -0.0249409, 0.0282549, 0.950593)
bones/57/rotation = Quaternion(-0.0485098, -0.0416133, 0.148497, 0.986845)
bones/58/rotation = Quaternion(-0.262372, -0.0188349, 0.0545949, 0.963237)
bones/59/rotation = Quaternion(-0.313217, 0.00485518, -0.00867476, 0.94963)
bones/60/rotation = Quaternion(-0.343146, 0.00202832, -0.00216272, 0.939278)
bones/61/position = Vector3(1.08644e-05, 0.421464, -0.995448)
bones/61/rotation = Quaternion(0.901525, 5.17449e-06, 8.67284e-07, -0.432726)
bones/62/position = Vector3(-2.09548e-11, 0.762718, -1.06807e-06)
bones/62/rotation = Quaternion(-0.440034, 7.51537e-07, -2.99081e-06, 0.897981)
bones/63/rotation = Quaternion(-0.310786, 1.2196e-06, -1.66228e-06, 0.95048)
bones/64/rotation = Quaternion(0.13018, -3.82313e-07, 3.26956e-06, 0.991491)
bones/65/rotation = Quaternion(0.413525, -2.98891e-07, 3.21659e-06, 0.910493)
bones/66/position = Vector3(-0.139139, 0.832018, -0.00539021)
bones/66/rotation = Quaternion(0.422596, 7.76257e-07, -4.64418e-07, 0.906318)
bones/67/rotation = Quaternion(-0.686962, 0.341712, 0.613755, -0.186067)
bones/68/rotation = Quaternion(2.23091e-08, -0.0725693, 1.61508e-07, 0.997363)
bones/69/rotation = Quaternion(9.16397e-08, -0.036178, 7.06966e-09, 0.999345)
bones/69/scale = Vector3(1, 1, 1)
bones/70/rotation = Quaternion(5.09523e-07, -1.31735e-07, -0.806392, 0.591381)
bones/71/rotation = Quaternion(0.382594, -0.529481, 0.516432, 0.553687)
bones/71/scale = Vector3(0.999983, 0.999999, 1)
bones/72/rotation = Quaternion(-0.0337743, 0.7957, 0.604556, -0.0152309)
bones/74/rotation = Quaternion(0.0387335, 0.0124004, -0.0954496, 0.994603)
bones/75/rotation = Quaternion(-0.0413102, 0.0186066, -0.00478416, 0.998962)
bones/76/position = Vector3(-0.457134, 2.37732, 0.718382)
bones/76/rotation = Quaternion(0.617476, -0.0045208, 0.0592875, 0.784339)
bones/77/rotation = Quaternion(-0.0506552, 0.00347161, 0.00273734, 0.998707)
bones/79/rotation = Quaternion(0.275304, -0.0119429, 0.00395396, 0.961275)
bones/80/position = Vector3(-0.231558, 2.3936, 0.726023)
bones/80/rotation = Quaternion(0.617426, -0.00573294, 0.0608166, 0.784254)
bones/81/rotation = Quaternion(-0.0501543, 0.00290271, -0.0124602, 0.99866)
bones/83/rotation = Quaternion(0.276996, -0.00934272, -0.0287707, 0.960395)
bones/84/position = Vector3(0.0273813, 2.41222, 0.740163)
bones/84/rotation = Quaternion(0.617215, -0.0102664, 0.0665658, 0.783906)
bones/85/rotation = Quaternion(-0.0507703, 0.00455558, 0.00562549, 0.998684)
bones/87/rotation = Quaternion(0.277072, -0.00964411, -0.0298344, 0.960338)
bones/88/position = Vector3(0.216818, 2.42017, 0.698505)
bones/88/rotation = Quaternion(0.604556, 0.0152298, 0.0337728, 0.795701)
bones/89/rotation = Quaternion(5.11922e-09, 5.75324e-06, 5.30854e-07, 1)
bones/91/rotation = Quaternion(0.271662, 2.01161e-06, 0.00389831, 0.962385)
bones/92/rotation = Quaternion(3.33429e-09, -0.028167, 1.12803e-07, 0.999603)
bones/93/rotation = Quaternion(-6.99774e-08, -0.0141063, -5.70193e-08, 0.999901)
bones/93/scale = Vector3(1, 1, 1)
bones/95/rotation = Quaternion(0.108426, -0.120463, -0.167791, 0.972409)
bones/96/rotation = Quaternion(-2.73647e-08, 0.0725707, 9.60945e-08, 0.997363)
bones/97/rotation = Quaternion(-4.05433e-08, 0.0361787, 2.09295e-07, 0.999345)
bones/97/scale = Vector3(1, 1, 1)
bones/98/rotation = Quaternion(1.41334e-07, -4.09585e-09, 0.806391, 0.591383)
bones/99/rotation = Quaternion(0.427987, 0.481393, -0.57279, 0.506951)
bones/100/rotation = Quaternion(0.0218515, 0.851322, 0.52408, 0.0106526)
bones/102/rotation = Quaternion(0.0387337, -0.0124003, 0.0954498, 0.994603)
bones/103/rotation = Quaternion(-0.0413101, -0.0186066, 0.00478416, 0.998962)
bones/104/position = Vector3(0.394101, 2.48257, 0.241305)
bones/104/rotation = Quaternion(0.537792, 0.00667681, -0.0493171, 0.841608)
bones/105/rotation = Quaternion(-0.0506551, -0.00347132, -0.0027371, 0.998706)
bones/107/rotation = Quaternion(0.275305, 0.0119429, -0.00395397, 0.961275)
bones/108/position = Vector3(0.168162, 2.49422, 0.246205)
bones/108/rotation = Quaternion(0.537735, 0.00773303, -0.0509583, 0.841537)
bones/109/rotation = Quaternion(-0.0501542, -0.0029024, 0.0124605, 0.99866)
bones/111/rotation = Quaternion(0.276996, 0.00934272, 0.0287708, 0.960395)
bones/112/position = Vector3(-0.0912048, 2.50858, 0.257107)
bones/112/rotation = Quaternion(0.537501, 0.0116801, -0.0571269, 0.841245)
bones/113/rotation = Quaternion(-0.0507702, -0.00455525, -0.00562522, 0.998684)
bones/115/rotation = Quaternion(0.277072, 0.0096441, 0.0298345, 0.960337)
bones/116/position = Vector3(-0.280678, 2.50341, 0.215176)
bones/116/rotation = Quaternion(0.52408, -0.010652, -0.0218505, 0.851322)
bones/117/rotation = Quaternion(1.63445e-07, -5.43147e-06, -3.06521e-07, 1)
bones/119/rotation = Quaternion(0.271662, -2.0389e-06, -0.00389826, 0.962385)
bones/120/rotation = Quaternion(-1.59959e-08, 0.0281669, 7.09801e-08, 0.999603)
bones/121/rotation = Quaternion(-8.9174e-08, 0.0141062, -1.48066e-08, 0.999901)
bones/121/scale = Vector3(1, 1, 1)

[editable path="werewolf"]
